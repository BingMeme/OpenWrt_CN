# 非重新写盘的刷写固件方式

不保留配置 上传刷写固件：         

![Upgrade](https://user-images.githubusercontent.com/73426989/150647733-6862e268-df43-4f4a-8136-0a9dab515a4c.png)              

* 喜欢保留配置升级或恢复配置备份升级的大神们，请自行解决问题。              
* 强烈建议不要解压缩.gz格式，可以直接上传升级的。若失败，再解压到.img上传升级。若还是失败，则最终重新写盘包治百病。                 
* 如果有外接硬盘作为类NAS程序的盘使用，请先拔掉硬盘，再动固件！                   
* 不论您是PVE等虚拟机下安装的还是物理机下安装的OpenWrt，都可上传升级/切换OpenWrt固件。                     



【过时内容】：                
DD已经不推荐使用了，因为根据反馈DD不兼容的情况高于Web不保留配置升级的情况👇                    

dd命令升级的用法：            
① 即使前后固件的root分区大小不一致也可行           
② 解压到.img格式有可能是.gz大小的10倍假如root分区给了1024MB......一般情况下虚拟机用户给的虚拟硬盘都是偏小的，所以请注意dd升级空间条件你是否满足？               
第1步:                
把你下载的固件gz后缀的解压缩，出来是img后缀的，文件名改成op.img（方便第三步输入短文件名）                 
第2步:              
系统-文件传输（或者其他SCP/FTP工具连接到后台传输）-上传（默认上传到/tmp/upload目录，不要重启固件，否则/tmp目录会清空。如果没有upload目录，需要手动创建目录）                 
第3步:               
op里面系统-ttyd终端（或者其他SSH工具连接到固件后台）-输入命令：             

```
dd if=/tmp/upload/op.img of=/dev/sda
```

（上面命令最后的参数：sda还是sdb还是sdc，请确认清楚，你要把固件写到哪个盘）                   
第4步:               
等待完毕后会提示....out字样         
然后执行        

```
reboot
```

命令或者断电给电重启固件即可。                 



[返回主页](../README.md)                   




